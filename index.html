<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gestionnaire √âquipe U11F2 - Basket</title>
    <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        .loading-spinner {
            border: 4px solid #f3f4f6;
            border-top: 4px solid #3b82f6;
            border-radius: 50%;
            width: 20px;
            height: 20px;
            animation: spin 1s linear infinite;
            display: inline-block;
            margin-left: 8px;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script>
        window.addEventListener('load', function() {
            console.log('Window loaded, initializing React app...');

            if (typeof React === 'undefined' || typeof ReactDOM === 'undefined') {
                document.getElementById('root').innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background-color: #fef2f2;">
                        <div style="text-align: center; background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);">
                            <h1 style="color: #dc2626; font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">Erreur de chargement</h1>
                            <p style="color: #6b7280;">React ou ReactDOM n'est pas charg√©. V√©rifiez votre connexion internet.</p>
                            <button onclick="location.reload()" style="background: #3b82f6; color: white; padding: 0.5rem 1rem; border: none; border-radius: 0.25rem; cursor: pointer; margin-top: 1rem;">
                                Recharger
                            </button>
                        </div>
                    </div>
                `;
                return;
            }

            const { useState, useEffect } = React;

            // Password Protection Component
            function PasswordProtection({ onAuth }) {
                const [password, setPassword] = useState('');
                const [error, setError] = useState('');

                const handleSubmit = (e) => {
                    e.preventDefault();
                    if (password === 'basket2025') {
                        onAuth(true);
                    } else {
                        setError('Mot de passe incorrect');
                        setPassword('');
                    }
                };

                return React.createElement('div', {
                    style: {
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        minHeight: '100vh',
                        backgroundColor: '#f9fafb'
                    }
                },
                    React.createElement('div', {
                        style: {
                            background: 'white',
                            padding: '2rem',
                            borderRadius: '0.5rem',
                            boxShadow: '0 10px 15px -3px rgba(0, 0, 0, 0.1)',
                            width: '100%',
                            maxWidth: '28rem'
                        }
                    },
                        React.createElement('div', { style: { textAlign: 'center', marginBottom: '1.5rem' } },
                            React.createElement('h1', {
                                style: {
                                    color: '#1e40af',
                                    fontSize: '1.5rem',
                                    fontWeight: 'bold',
                                    marginBottom: '0.5rem'
                                }
                            }, 'üèÄ Gestionnaire √âquipe U11F2'),
                            React.createElement('p', { style: { color: '#6b7280' } }, 'Acc√®s prot√©g√©')
                        ),
                        React.createElement('form', { onSubmit: handleSubmit },
                            React.createElement('div', { style: { marginBottom: '1rem' } },
                                React.createElement('label', {
                                    style: {
                                        display: 'block',
                                        fontSize: '0.875rem',
                                        fontWeight: '500',
                                        color: '#374151',
                                        marginBottom: '0.5rem'
                                    }
                                }, 'Mot de passe'),
                                React.createElement('input', {
                                    type: 'password',
                                    value: password,
                                    onChange: (e) => setPassword(e.target.value),
                                    placeholder: 'Entrez le mot de passe',
                                    required: true,
                                    style: {
                                        width: '100%',
                                        padding: '0.75rem',
                                        border: '1px solid #d1d5db',
                                        borderRadius: '0.5rem',
                                        fontSize: '1rem',
                                        outline: 'none',
                                        boxSizing: 'border-box'
                                    }
                                })
                            ),
                            error && React.createElement('div', {
                                style: {
                                    marginBottom: '1rem',
                                    padding: '0.75rem',
                                    backgroundColor: '#fee2e2',
                                    border: '1px solid #fca5a5',
                                    color: '#991b1b',
                                    borderRadius: '0.5rem',
                                    fontSize: '0.875rem'
                                }
                            }, error),
                            React.createElement('button', {
                                type: 'submit',
                                style: {
                                    width: '100%',
                                    backgroundColor: '#3b82f6',
                                    color: 'white',
                                    padding: '0.75rem 1rem',
                                    border: 'none',
                                    borderRadius: '0.5rem',
                                    fontSize: '1rem',
                                    fontWeight: '500',
                                    cursor: 'pointer'
                                }
                            }, 'Acc√©der')
                        )
                    )
                );
            }

            // Main Basketball Team Manager Component
            function BasketTeamManager() {
                const [selectedDate, setSelectedDate] = useState(null);
                const [matches, setMatches] = useState({});
                const [loading, setLoading] = useState(false);
                const [error, setError] = useState('');

                const players = [
                    { name: "Lila", parentName: "Parent Lila", email: "***@***.fr", phone: "06 ** ** ** 84" },
                    { name: "Eve", parentName: "Parents Eve & Jeanne", email: "***@***.com", phone: "06 ** ** ** 01" },
                    { name: "Jeanne", parentName: "Parents Eve & Jeanne", email: "***@***.com", phone: "06 ** ** ** 01" },
                    { name: "Emma", parentName: "Parent Emma", email: "***@***.fr", phone: "06 ** ** ** 67" },
                    { name: "Valentine", parentName: "Parent Valentine", email: "***@***.fr", phone: "06 ** ** ** 34" },
                    { name: "Cl√©mence", parentName: "Parent Cl√©mence", email: "***@***.fr", phone: "07 ** ** ** 98" },
                    { name: "Stella", parentName: "Parent Stella", email: "***@***.com", phone: "06 ** ** ** 82" },
                    { name: "Cl√©a", parentName: "Parent Cl√©a", email: "***@***.com", phone: "06 ** ** ** 85" }
                ];

                const [matchForm, setMatchForm] = useState({
                    club: '',
                    address: '',
                    time: '',
                    location: '',
                    jerseyParent: '',
                    drivers: ['', '', ''],
                    snackParents: ['', ''],
                    matchSheetReferee: '',
                    matchSheetPlayers: ['', '']
                });

                // Club addresses
                const clubAddresses = {
                    'THORIGNE FOUILLARD BC': '30 Rue du Champ M√©loin, 35235 THORIGNE-FOUILLARD',
                    'PACE CO-1': '54 Avenue Le BRIX, 35740 PACE',
                    'LIFFRE US-2': '15 RUE JULES VERNE, 35340 LIFFRE',
                    'BETTON CS-1': 'Le prieur√©, 35830 BETTON'
                };

                // Game dates and opponent info
                const gameDates = {
                    'J1': {
                        full: 'Samedi 27 Septembre',
                        short: '27/09 - J1',
                        club: 'LIFFRE US-2',
                        location: 'Ext√©rieur',
                        address: clubAddresses['LIFFRE US-2'],
                        date: new Date(2024, 8, 27) // September 27, 2024
                    },
                    'J2': {
                        full: 'Samedi 4 Octobre',
                        short: '04/10 - J2',
                        club: 'PACE CO-1',
                        location: 'Domicile',
                        address: '43 Rue de D√©zerseul, 35510 CESSON-SEVIGNE',
                        date: new Date(2024, 9, 4) // October 4, 2024
                    },
                    'J3': {
                        full: 'Pas de match',
                        short: 'J3 - Repos',
                        club: '',
                        location: '',
                        address: '',
                        date: null
                    },
                    'J4': {
                        full: 'Samedi 18 Octobre',
                        short: '18/10 - J4',
                        club: 'BETTON CS-1',
                        location: 'Ext√©rieur',
                        address: clubAddresses['BETTON CS-1'],
                        date: new Date(2024, 9, 18) // October 18, 2024
                    },
                    'J5': {
                        full: 'Samedi 1er Novembre',
                        short: '01/11 - J5',
                        club: 'THORIGNE FOUILLARD BC',
                        location: 'Domicile',
                        address: '43 Rue de D√©zerseul, 35510 CESSON-SEVIGNE',
                        date: new Date(2024, 10, 1) // November 1, 2024
                    },
                    'J6': {
                        full: 'Samedi 8 Novembre',
                        short: '08/11 - J6',
                        club: 'LIFFRE US-2',
                        location: 'Domicile',
                        address: '43 Rue de D√©zerseul, 35510 CESSON-SEVIGNE',
                        date: new Date(2024, 10, 8) // November 8, 2024
                    },
                    'J7': {
                        full: 'Samedi 15 Novembre',
                        short: '15/11 - J7',
                        club: 'PACE CO-1',
                        location: 'Ext√©rieur',
                        address: clubAddresses['PACE CO-1'],
                        date: new Date(2024, 10, 15) // November 15, 2024
                    },
                    'J8': {
                        full: 'Pas de match',
                        short: 'J8 - Repos',
                        club: '',
                        location: '',
                        address: '',
                        date: null
                    },
                    'J9': {
                        full: 'Samedi 29 Novembre',
                        short: '29/11 - J9',
                        club: 'BETTON CS-1',
                        location: 'Domicile',
                        address: '43 Rue de D√©zerseul, 35510 CESSON-SEVIGNE',
                        date: new Date(2024, 10, 29) // November 29, 2024
                    },
                    'J10': {
                        full: 'Samedi 6 D√©cembre',
                        short: '06/12 - J10',
                        club: 'THORIGNE FOUILLARD BC',
                        location: 'Ext√©rieur',
                        address: clubAddresses['THORIGNE FOUILLARD BC'],
                        date: new Date(2024, 11, 6) // December 6, 2024
                    }
                };

                // Find next game
                const findNextGame = () => {
                    const today = new Date();
                    today.setHours(0, 0, 0, 0); // Start of today

                    // Get all games with dates, sorted by date
                    const upcomingGames = Object.entries(gameDates)
                        .filter(([key, game]) => game.date && game.club) // Only games with dates and opponents
                        .filter(([key, game]) => game.date >= today) // Only future/today games
                        .sort(([a, gameA], [b, gameB]) => gameA.date - gameB.date); // Sort by date

                    return upcomingGames.length > 0 ? upcomingGames[0] : null;
                };

                const nextGame = findNextGame();

                // Load matches from database
                const loadMatches = async () => {
                    try {
                        console.log('Loading matches from database...');
                        const response = await fetch('/api/matches');

                        if (response.ok) {
                            const data = await response.json();
                            console.log('Database response:', data);

                            // Check if we actually have match data
                            const hasExistingData = data.matches && Object.keys(data.matches).length > 0;
                            console.log('Has existing data:', hasExistingData);

                            // Fill in missing games with defaults
                            const allMatches = {};
                            for (let i = 1; i <= 14; i++) {
                                const gameKey = `J${i}`;
                                allMatches[gameKey] = data.matches[gameKey] || {
                                    club: gameDates[gameKey]?.club || '',
                                    address: gameDates[gameKey]?.address || '',
                                    time: '',
                                    location: gameDates[gameKey]?.location || '',
                                    jerseyParent: '',
                                    drivers: ['', '', ''],
                                    snackParents: ['', ''],
                                    matchSheetReferee: '',
                                    matchSheetPlayers: ['', ''],
                                    attendance: players.reduce((acc, player) => {
                                        acc[player.name] = true;
                                        return acc;
                                    }, {})
                                };
                            }

                            setMatches(allMatches);

                            if (!hasExistingData) {
                                console.warn('No existing match data found in database');
                            }
                        } else {
                            console.error('Database request failed with status:', response.status);
                            throw new Error(`Failed to load matches: ${response.status}`);
                        }
                    } catch (error) {
                        console.error('Error loading matches:', error);
                        console.log('Falling back to default matches');
                        // Fall back to default matches
                        loadDefaultMatches();
                    }
                };

                const loadDefaultMatches = () => {
                    const initialMatches = {};
                    for (let i = 1; i <= 14; i++) {
                        const gameKey = `J${i}`;
                        initialMatches[gameKey] = {
                            club: gameDates[gameKey]?.club || '',
                            address: gameDates[gameKey]?.address || '',
                            time: '',
                            location: gameDates[gameKey]?.location || '',
                            jerseyParent: '',
                            drivers: ['', '', ''],
                            snackParents: ['', ''],
                            matchSheetReferee: '',
                            matchSheetPlayers: ['', ''],
                            attendance: players.reduce((acc, player) => {
                                acc[player.name] = true;
                                return acc;
                            }, {})
                        };
                    }
                    setMatches(initialMatches);
                };

                // Load matches on component mount
                useEffect(() => {
                    loadMatches();
                }, []);


                const handleGameClick = (gameKey) => {
                    try {
                        console.log('Clicking game:', gameKey);
                        console.log('Game data:', gameDates[gameKey]);
                        console.log('Existing matches:', matches);
                        console.log('Match data for', gameKey, ':', matches[gameKey]);

                        setSelectedDate(gameKey);

                        if (matches[gameKey]) {
                            console.log('Using existing match data for', gameKey);
                            // Ensure address is populated from gameDates if missing
                            const matchData = { ...matches[gameKey] };
                            console.log('Initial match data:', matchData);

                            if (!matchData.address && gameDates[gameKey]?.address) {
                                matchData.address = gameDates[gameKey].address;
                                console.log('Added address from gameDates:', matchData.address);
                            }

                            // Ensure attendance is properly initialized
                            if (!matchData.attendance) {
                                console.log('Initializing attendance for', gameKey);
                                matchData.attendance = players.reduce((acc, player) => {
                                    acc[player.name] = true;
                                    return acc;
                                }, {});
                            }

                            // Ensure arrays are properly initialized
                            if (!matchData.drivers || !Array.isArray(matchData.drivers)) {
                                console.log('Initializing drivers for', gameKey);
                                matchData.drivers = ['', '', ''];
                            }
                            if (!matchData.snackParents || !Array.isArray(matchData.snackParents)) {
                                console.log('Initializing snackParents for', gameKey);
                                matchData.snackParents = ['', ''];
                            }
                            if (!matchData.matchSheetPlayers || !Array.isArray(matchData.matchSheetPlayers)) {
                                console.log('Initializing matchSheetPlayers for', gameKey);
                                matchData.matchSheetPlayers = ['', ''];
                            }

                            console.log('Final match data:', matchData);
                            setMatchForm(matchData);
                        } else {
                            console.log('Creating new match data for', gameKey);
                            const newMatchData = {
                                club: gameDates[gameKey]?.club || '',
                                address: gameDates[gameKey]?.address || '',
                                time: '',
                                location: gameDates[gameKey]?.location || '',
                                jerseyParent: '',
                                drivers: ['', '', ''],
                                snackParents: ['', ''],
                                matchSheetReferee: '',
                                matchSheetPlayers: ['', ''],
                                attendance: players.reduce((acc, player) => {
                                    acc[player.name] = true;
                                    return acc;
                                }, {})
                            };
                            console.log('New match data:', newMatchData);
                            setMatchForm(newMatchData);
                        }
                        console.log('Game click completed successfully for', gameKey);
                    } catch (error) {
                        console.error('Error in handleGameClick for', gameKey, ':', error);
                        console.error('Error stack:', error.stack);
                        setError(`Erreur lors du chargement de ${gameKey}: ${error.message}`);
                        // Reset to safe state
                        setSelectedDate(null);
                    }
                };

                const saveMatch = async () => {
                    if (!selectedDate) return;

                    setLoading(true);
                    setError('');

                    try {
                        const response = await fetch('/api/matches', {
                            method: 'POST',
                            headers: {
                                'Content-Type': 'application/json'
                            },
                            body: JSON.stringify({
                                gameKey: selectedDate,
                                matchData: matchForm
                            })
                        });

                        if (response.ok) {
                            // Update local state
                            setMatches(prev => ({
                                ...prev,
                                [selectedDate]: matchForm
                            }));

                            // Show success message with details
                            const presentCount = matchForm.attendance ? Object.values(matchForm.attendance).filter(Boolean).length : 0;
                            alert(`${selectedDate} sauvegard√© avec succ√®s !\n${presentCount}/${players.length} joueuses pr√©sentes`);

                            setError('');
                        } else {
                            const errorData = await response.text();
                            console.error('Save failed:', response.status, errorData);
                            throw new Error(`Erreur de sauvegarde (${response.status}): ${errorData}`);
                        }
                    } catch (error) {
                        console.error('Error saving match:', error);

                        // Try to show more specific error
                        let errorMessage = 'Erreur lors de la sauvegarde.';
                        if (error.message.includes('Failed to fetch')) {
                            errorMessage = 'Impossible de contacter le serveur. V√©rifiez votre connexion.';
                        } else if (error.message.includes('500')) {
                            errorMessage = 'Erreur du serveur de base de donn√©es.';
                        } else if (error.message.includes('404')) {
                            errorMessage = 'Service de sauvegarde non trouv√©.';
                        }

                        setError(errorMessage + ' D√©tails: ' + error.message);
                    }

                    setLoading(false);
                };

                return React.createElement('div', { className: 'max-w-6xl mx-auto p-6 bg-gray-50 min-h-screen' },
                    // Header
                    React.createElement('div', { className: 'text-center mb-8' },
                        React.createElement('h1', { className: 'text-4xl font-bold text-blue-800 mb-2' },
                            'üèÄ Gestionnaire √âquipe U11F2'
                        ),
                        React.createElement('p', { className: 'text-gray-600' }, 'Organisation des matchs - Parents et encadrement'),
                        React.createElement('p', { className: 'text-sm text-gray-500 mt-1' },
                            '‚ö° Base de donn√©es Neon ‚Ä¢ üîÑ Sauvegarde automatique'
                        ),
                        React.createElement('div', { className: 'mt-3 space-y-3' },
                            // Next game display
                            nextGame && React.createElement('div', {
                                className: 'inline-block px-6 py-4 bg-gradient-to-r from-blue-500 to-blue-600 text-white rounded-lg shadow-lg'
                            },
                                React.createElement('div', { className: 'text-center' },
                                    React.createElement('div', { className: 'text-sm font-medium opacity-90' }, 'üöÄ Prochain match'),
                                    React.createElement('div', { className: 'text-lg font-bold' }, nextGame[1].full),
                                    React.createElement('div', { className: 'text-sm' },
                                        `${nextGame[1].location} vs ${nextGame[1].club}`
                                    ),
                                    nextGame[1].address && React.createElement('div', {
                                        className: 'text-xs mt-1 opacity-75 cursor-pointer hover:opacity-100 underline',
                                        onClick: () => window.open(`https://www.google.com/maps/search/${encodeURIComponent(nextGame[1].address)}`, '_blank')
                                    }, 'üìç ' + nextGame[1].address)
                                )
                            ),
                            React.createElement('div', null,
                                React.createElement('a', {
                                    href: 'https://competitions.ffbb.com/ligues/bre/comites/0035/clubs/bre0035013/equipes/200000005186561',
                                    target: '_blank',
                                    rel: 'noopener noreferrer',
                                    className: 'inline-flex items-center px-4 py-2 bg-orange-100 text-orange-800 rounded-lg hover:bg-orange-200 transition-colors text-sm font-medium'
                                },
                                    React.createElement('span', { className: 'mr-2' }, 'üèÄ'),
                                    'F√©d√©ration FFBB - √âquipe U11F2'
                                )
                            )
                        ),
                    ),

                    // Games grid (J1-J14)
                    React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6' },
                        React.createElement('h2', { className: 'text-2xl font-bold text-blue-800 mb-4' }, 'Calendrier des matchs - Saison 2025/26'),
                        React.createElement('div', { className: 'grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 xl:grid-cols-7 gap-4' },
                            // Generate 14 game buttons (J1-J14)
                            Array.from({ length: 14 }, (_, i) => {
                                const gameKey = `J${i + 1}`;
                                const hasMatchData = matches[gameKey] && (matches[gameKey].club || matches[gameKey].time);
                                const gameDate = gameDates[gameKey];
                                const isRestDay = gameDate && !gameDate.club;

                                return React.createElement('button', {
                                    key: gameKey,
                                    onClick: isRestDay ? undefined : () => handleGameClick(gameKey),
                                    disabled: isRestDay,
                                    className: `p-4 text-center rounded-lg border-2 transition-all duration-200 ${
                                        isRestDay
                                            ? 'bg-gray-100 border-gray-300 text-gray-500 cursor-not-allowed'
                                            : hasMatchData
                                            ? 'bg-blue-100 border-blue-500 text-blue-800 font-semibold shadow-md hover:bg-blue-200 cursor-pointer'
                                            : 'bg-gray-50 border-gray-200 text-gray-700 hover:bg-blue-50 hover:border-blue-300 cursor-pointer'
                                    }`
                                },
                                    React.createElement('div', { className: 'font-bold text-sm' },
                                        gameDate ? gameDate.short : gameKey
                                    ),
                                    React.createElement('div', { className: 'text-xs mt-1' },
                                        gameDate && gameDate.club ? `${gameDate.location}` :
                                        gameDate ? '' : 'Journ√©e ' + (i + 1)
                                    )
                                );
                            })
                        )
                    ),

                    // Error display
                    error && React.createElement('div', { className: 'mb-4 p-4 bg-yellow-100 border border-yellow-400 text-yellow-700 rounded-lg' },
                        '‚ö†Ô∏è ', error
                    ),

                    // Match form (when date is selected)
                    selectedDate && React.createElement('div', { className: 'bg-white rounded-lg shadow-lg p-6 mb-6 border-2 border-blue-200' },
                        React.createElement('div', { className: 'flex justify-between items-center mb-6' },
                            React.createElement('h3', { className: 'text-2xl font-bold text-blue-800 flex items-center' },
                                `üèÄ ${gameDates[selectedDate] ? `${selectedDate} - ${gameDates[selectedDate].full}` : `${selectedDate} - ${selectedDate.replace('J', 'Journ√©e ')}`}`
                            ),
                            React.createElement('button', {
                                onClick: () => setSelectedDate(null),
                                className: 'text-gray-500 hover:text-gray-700 text-2xl font-bold hover:bg-gray-100 rounded-full w-8 h-8 flex items-center justify-center'
                            }, '√ó')
                        ),

                        React.createElement('div', { className: 'grid grid-cols-1 lg:grid-cols-3 gap-8' },
                            // Match info column
                            React.createElement('div', { className: 'space-y-6' },
                                React.createElement('h4', { className: 'text-lg font-semibold text-gray-800 border-b pb-2' },
                                    '‚ÑπÔ∏è Informations du match'
                                ),

                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üèÄ Club adverse'),
                                    React.createElement('input', {
                                        type: 'text',
                                        value: matchForm.club,
                                        readOnly: true,
                                        className: 'w-full p-3 border border-gray-300 rounded-lg bg-gray-50 text-gray-600 cursor-not-allowed',
                                        placeholder: 'Nom du club adverse'
                                    })
                                ),

                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üè† Lieu'),
                                    React.createElement('div', { className: 'space-y-2' },
                                        React.createElement('div', {
                                            className: `w-full p-3 border border-gray-300 rounded-lg cursor-pointer ${
                                                matchForm.location === 'Domicile'
                                                    ? 'bg-green-50 text-green-800 border-green-300 hover:bg-green-100'
                                                    : 'bg-orange-50 text-orange-800 border-orange-300 hover:bg-orange-100'
                                            } transition-colors`,
                                            onClick: () => {
                                                if (matchForm.address && matchForm.address !== 'Adresse √† confirmer') {
                                                    window.open(`https://www.google.com/maps/search/${encodeURIComponent(matchForm.address)}`, '_blank');
                                                }
                                            }
                                        },
                                            React.createElement('span', {
                                                className: `font-medium ${matchForm.address && matchForm.address !== 'Adresse √† confirmer' ? 'underline' : ''}`
                                            }, matchForm.address || 'Adresse non d√©finie')
                                        )
                                    )
                                ),

                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üïê Heure de RDV'),
                                    React.createElement('input', {
                                        type: 'time',
                                        value: matchForm.time,
                                        onChange: (e) => setMatchForm({...matchForm, time: e.target.value}),
                                        className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                    })
                                ),

                            ),

                            // Organization column
                            React.createElement('div', { className: 'space-y-6' },
                                React.createElement('h4', { className: 'text-lg font-semibold text-gray-800 border-b pb-2' },
                                    'üë• Organisation'
                                ),

                                React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üëï Parent r√©f√©rent maillots'),
                                    React.createElement('select', {
                                        value: matchForm.jerseyParent,
                                        onChange: (e) => setMatchForm({...matchForm, jerseyParent: e.target.value}),
                                        className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                    },
                                        React.createElement('option', { value: '' }, 'S√©lectionner un parent'),
                                        [...new Set(players.map(player => player.parentName))].map((parentName, index) =>
                                            React.createElement('option', { key: index, value: parentName },
                                                parentName
                                            )
                                        )
                                    )
                                ),

                                // Only show drivers for away games
                                matchForm.location === 'Ext√©rieur' && React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üöó Parents conducteurs (3 voitures)'),
                                    React.createElement('div', { className: 'space-y-2' },
                                        (matchForm.drivers || ['', '', '']).map((driver, index) =>
                                            React.createElement('select', {
                                                key: index,
                                                value: driver,
                                                onChange: (e) => {
                                                    const newDrivers = [...matchForm.drivers];
                                                    newDrivers[index] = e.target.value;
                                                    setMatchForm({...matchForm, drivers: newDrivers});
                                                },
                                                className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                            },
                                                React.createElement('option', { value: '' }, `Voiture ${index + 1} - S√©lectionner un parent`),
                                                [...new Set(players.map(player => player.parentName))].map((parentName, playerIndex) =>
                                                    React.createElement('option', { key: playerIndex, value: parentName },
                                                        parentName
                                                    )
                                                )
                                            )
                                        )
                                    )
                                ),

                                // Only show snack parents for home games
                                matchForm.location === 'Domicile' && React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üç™ Responsables du go√ªter'),
                                    React.createElement('div', { className: 'space-y-2' },
                                        (matchForm.snackParents || ['', '']).map((parent, index) =>
                                            React.createElement('select', {
                                                key: index,
                                                value: parent,
                                                onChange: (e) => {
                                                    const newSnackParents = [...matchForm.snackParents];
                                                    newSnackParents[index] = e.target.value;
                                                    setMatchForm({...matchForm, snackParents: newSnackParents});
                                                },
                                                className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                            },
                                                React.createElement('option', { value: '' }, `Responsable go√ªter ${index + 1}`),
                                                [...new Set(players.map(player => player.parentName))].map((parentName, playerIndex) =>
                                                    React.createElement('option', { key: playerIndex, value: parentName },
                                                        parentName
                                                    )
                                                )
                                            )
                                        )
                                    )
                                ),

                                // Only show match sheet fields for home games
                                matchForm.location === 'Domicile' && React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üìã R√©f√©rent feuille de match'),
                                    React.createElement('select', {
                                        value: matchForm.matchSheetReferee,
                                        onChange: (e) => setMatchForm({...matchForm, matchSheetReferee: e.target.value}),
                                        className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                    },
                                        React.createElement('option', { value: '' }, 'S√©lectionner un parent'),
                                        [...new Set(players.map(player => player.parentName))].map((parentName, index) =>
                                            React.createElement('option', { key: index, value: parentName },
                                                parentName
                                            )
                                        )
                                    )
                                ),

                                matchForm.location === 'Domicile' && React.createElement('div', null,
                                    React.createElement('label', { className: 'block text-sm font-medium text-gray-700 mb-2' }, 'üèÄ Joueuses √† la feuille de match'),
                                    React.createElement('div', { className: 'space-y-2' },
                                        (matchForm.matchSheetPlayers || ['', '']).map((player, index) =>
                                            React.createElement('select', {
                                                key: index,
                                                value: player,
                                                onChange: (e) => {
                                                    const newMatchSheetPlayers = [...matchForm.matchSheetPlayers];
                                                    newMatchSheetPlayers[index] = e.target.value;
                                                    setMatchForm({...matchForm, matchSheetPlayers: newMatchSheetPlayers});
                                                },
                                                className: 'w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent'
                                            },
                                                React.createElement('option', { value: '' }, `Joueuse ${index + 1} - S√©lectionner`),
                                                players.map((playerData, playerIndex) =>
                                                    React.createElement('option', { key: playerIndex, value: playerData.name },
                                                        playerData.name
                                                    )
                                                )
                                            )
                                        )
                                    )
                                )
                            ),

                            // Player attendance column
                            React.createElement('div', { className: 'space-y-6' },
                                React.createElement('h4', { className: 'text-lg font-semibold text-gray-800 border-b pb-2' },
                                    'üë• Pr√©sences des joueuses'
                                ),
                                React.createElement('div', { className: 'space-y-3' },
                                    players.map((player, index) =>
                                        React.createElement('div', {
                                            key: index,
                                            className: 'flex items-center justify-between p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors'
                                        },
                                            React.createElement('div', { className: 'flex items-center' },
                                                React.createElement('span', { className: 'font-medium text-gray-900' }, player.name)
                                            ),
                                            React.createElement('button', {
                                                onClick: () => {
                                                    const newAttendance = { ...(matchForm.attendance || {}) };
                                                    newAttendance[player.name] = !newAttendance[player.name];
                                                    setMatchForm({...matchForm, attendance: newAttendance});
                                                },
                                                className: `px-3 py-2 rounded-lg text-sm font-medium transition-colors ${
                                                    matchForm.attendance && matchForm.attendance[player.name]
                                                        ? 'bg-green-100 text-green-800 hover:bg-green-200'
                                                        : 'bg-red-100 text-red-800 hover:bg-red-200'
                                                }`
                                            },
                                                matchForm.attendance && matchForm.attendance[player.name]
                                                    ? '‚úì Pr√©sente'
                                                    : '‚úó Absente'
                                            )
                                        )
                                    )
                                )
                            )
                        ),

                        // Summary section
                        React.createElement('div', { className: 'mt-8 p-4 bg-blue-50 rounded-lg border border-blue-200' },
                            React.createElement('h4', { className: 'font-semibold text-blue-800 mb-3 flex items-center' }, 'üìã R√©sum√©'),
                            React.createElement('div', { className: 'grid grid-cols-1 md:grid-cols-2 gap-4 text-sm' },
                                matchForm.club && React.createElement('p', null,
                                    React.createElement('span', { className: 'font-medium' }, 'Adversaire : '),
                                    matchForm.club
                                ),
                                matchForm.time && React.createElement('p', null,
                                    React.createElement('span', { className: 'font-medium' }, 'RDV : '),
                                    matchForm.time
                                ),
                                matchForm.attendance && React.createElement('p', null,
                                    React.createElement('span', { className: 'font-medium' }, 'Pr√©sentes : '),
                                    `${Object.values(matchForm.attendance || {}).filter(Boolean).length}/${players.length} joueuses`
                                ),
                                matchForm.jerseyParent && React.createElement('p', null,
                                    React.createElement('span', { className: 'font-medium' }, 'Maillots : '),
                                    matchForm.jerseyParent
                                )
                            )
                        ),

                        React.createElement('div', { className: 'flex justify-between items-center mt-8 pt-6 border-t' },
                            React.createElement('button', {
                                onClick: () => setSelectedDate(null),
                                className: 'px-6 py-3 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors'
                            }, 'Fermer'),

                            React.createElement('button', {
                                onClick: saveMatch,
                                disabled: loading,
                                className: `px-8 py-3 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed transition-colors flex items-center ${loading ? 'cursor-wait' : ''}`
                            },
                                loading && React.createElement('div', { className: 'loading-spinner mr-2' }),
                                loading ? 'Sauvegarde...' : 'Enregistrer'
                            )
                        )
                    )
                );
            }

            // Main App Component
            function App() {
                const [isAuthenticated, setIsAuthenticated] = useState(false);

                if (!isAuthenticated) {
                    return React.createElement(PasswordProtection, { onAuth: setIsAuthenticated });
                }

                return React.createElement(BasketTeamManager);
            }

            // Global error handler for React errors
            window.addEventListener('error', function(event) {
                console.error('Global error caught:', event.error);
                console.error('Error details:', {
                    message: event.message,
                    filename: event.filename,
                    lineno: event.lineno,
                    colno: event.colno,
                    error: event.error
                });
                // Don't reload automatically, just log
            });

            window.addEventListener('unhandledrejection', function(event) {
                console.error('Unhandled promise rejection:', event.reason);
            });

            // Render the app
            try {
                ReactDOM.render(React.createElement(App), document.getElementById('root'));
                console.log('App rendered successfully');
            } catch (error) {
                console.error('Error rendering app:', error);
                document.getElementById('root').innerHTML = `
                    <div style="display: flex; align-items: center; justify-content: center; min-height: 100vh; background-color: #fef2f2;">
                        <div style="text-align: center; background: white; padding: 2rem; border-radius: 0.5rem; box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1);">
                            <h1 style="color: #dc2626; font-size: 1.5rem; font-weight: bold; margin-bottom: 1rem;">Erreur</h1>
                            <p style="color: #6b7280; margin-bottom: 1rem;">Erreur lors du rendu: ${error.message}</p>
                            <button onclick="location.reload()" style="background: #3b82f6; color: white; padding: 0.5rem 1rem; border: none; border-radius: 0.25rem; cursor: pointer;">
                                Recharger
                            </button>
                        </div>
                    </div>
                `;
            }
        });
    </script>
</body>
</html>